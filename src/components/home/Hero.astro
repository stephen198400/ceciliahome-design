---
import { Image } from 'astro:assets';
import heroImage from '../../assets/hero.jpg';
import medal from '../../assets/medal.png';
import thumbtackLogo from '../../assets/thumbtack-logo.png';
---

<section class="min-h-[66.67vh] flex items-center overflow-hidden bg-gray-100">
  <div class="container mx-auto px-4 py-8 sm:py-16 lg:py-24">
    <div class="flex flex-col md:flex-row items-stretch gap-8 lg:gap-12">
      <!-- Left Content -->
      <div class="w-full md:w-1/2 flex flex-col items-center md:items-start text-center md:text-left justify-center md:pr-4 lg:pr-8">
        <p class="text-gray-500 font-semibold text-sm sm:text-base ">
          CALIFORNIA LICENSED ENGINEERING & DESIGN
        </p>
        <h1 class="text-4xl sm:text-5xl  xl:text-6xl font-bold leading-tight sm:leading-snug lg:leading-tight mt-3 sm:mt-4">
          Your Local Design & Engineering <span class="text-primary">Experts</span>
        </h1>
        <p class="mt-4 sm:mt-6 lg:mt-8 text-base sm:text-lg lg:text-xl text-gray-500 max-w-sm sm:max-w-md lg:max-w-lg xl:max-w-xl leading-relaxed">
          Transform your space with our professional architectural and structural engineering services. We handle permits, plans, and design while you watch your vision become reality.
        </p>
        <div class="mt-6 sm:mt-8 lg:mt-10">
          <a
            href="#contactForm"
            class="inline-block px-6 sm:px-8 lg:px-10 py-3 sm:py-4 rounded-md bg-primary text-white hover:bg-primary/80 transition-all duration-300 text-base sm:text-lg hover:scale-105 shadow-md scroll-to-center"
          >
            Get A Free Consultation
          </a>
        </div>
        <div class="flex items-center gap-4 mt-6">
          <div class="flex  gap-2">
          <div class="flex flex-col gap-1">
            <div class="">
              <Image src={thumbtackLogo} alt="Thumbtack Logo" class="h-12 w-auto" />
            </div>
          </div>
        </div>
        <div class="flex items-center justify-center gap-1">
          <Image src={medal} alt="Google Logo" class="h-6 w-auto" />
          <p class="text-xl font-bold text-yellow-500">TOP 1</p>
        </div>
        </div>
      </div>

      <!-- Right Image -->
      <div class="w-full md:w-1/2 flex items-center justify-center">
        <div class="relative w-full h-0 pb-[75%] overflow-hidden rounded-xl">
          <Image
            src={heroImage}
            alt="Professional Designer"
            class="absolute inset-0 w-full h-full object-cover"
            width={1200}
            height={800}
            quality={100}
          />
        </div>
      </div>
    </div>
  </div>
</section> 

<script>
  // 优化后的滚动逻辑，减少位置调整次数，避免UI卡顿
  document.addEventListener('DOMContentLoaded', function() {
    const scrollButtons = document.querySelectorAll('.scroll-to-center');
    
    scrollButtons.forEach((button) => {
      button.addEventListener('click', function(e) {
        e.preventDefault();
        
        const clickedButton = e.currentTarget as HTMLAnchorElement;
        const href = clickedButton.getAttribute('href');
        
        if (!href || !href.startsWith('#')) return;
        
        const targetId = href.substring(1);
        const targetElement = document.getElementById(targetId);
        
        if (!targetElement) return;
        
        // 检测设备类型
        const isMobile = window.innerWidth < 768;
        const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !(window as any).MSStream;
        
        // 获取导航栏元素和高度
        const navbar = document.querySelector('nav') || document.querySelector('header');
        const navbarHeight = navbar ? navbar.offsetHeight : 0;
        
        // 根据设备类型设置不同的偏移量
        const additionalOffset = isMobile ? 20 : 10;
        
        // 获取表单section
        const targetSection = targetElement.closest('section') || targetElement;
        
        // 预先计算位置，确保只滚动一次
        // 等待一小段时间确保DOM完全更新
        setTimeout(() => {
          // 计算目标位置时考虑当前滚动位置的影响
          const sectionTop = targetSection.getBoundingClientRect().top + window.scrollY;
          let scrollPosition = sectionTop - navbarHeight - additionalOffset;
          
          // 对iOS设备进行特殊处理，使用不同的滚动行为
          if (isIOS) {
            // iOS设备使用position:fixed对上方导航栏处理不同，调整位置
            scrollPosition -= 10; // 额外微调，针对iOS
            
            // 对iOS使用两步滚动，先快速到达，再精确定位
            window.scrollTo(0, scrollPosition);
            
            // 很小的延迟后再次确认位置
            requestAnimationFrame(() => {
              window.scrollTo({
                top: scrollPosition,
                behavior: 'smooth'
              });
            });
          } else {
            // 非iOS设备直接使用平滑滚动
            window.scrollTo({
              top: scrollPosition,
              behavior: 'smooth'
            });
          }
        }, isMobile ? 50 : 10); // 移动设备给予更多时间
      });
    });
  });
</script> 